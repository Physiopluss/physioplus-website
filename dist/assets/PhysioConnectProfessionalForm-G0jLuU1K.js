import{d as t,e as ae,u as te,c as le,a9 as ie,_ as o,aQ as ne,j as e,aR as oe,r as u}from"./index-B5YKgjKu.js";import{G as ce}from"./index-BCaAT4L7.js";import{b as de,g as pe,c as me,d as ue}from"./physioConnect-uRCnyBzu.js";import{u as ge,c as U,b as W,a as v,f as X}from"./formik.esm-VRL_jFfB.js";import{S as xe}from"./StepIndicator-DUZIKhhO.js";const Ne=()=>{var C,k,P,A,_,E,T,M,q,V,B,G,R,O,$,L,Y,H,Q;const[g,Z]=t.useState([]),[p,ee]=t.useState([]),[l,se]=t.useState(),D=ae(),re=te(),[x,S]=t.useState(!1),[h,F]=t.useState(!1),f=le(r=>{var a;return(a=r==null?void 0:r.physioConnectAuth)==null?void 0:a.physioId}),[b,z]=t.useState(!1),N=t.useRef(null),j=t.useRef(null),w=t.useRef(null);t.useEffect(()=>{const r=a=>{N.current&&!N.current.contains(a.target)&&z(!1),w.current&&!w.current.contains(a.target)&&F(!1),j.current&&!j.current.contains(a.target)&&S(!1)};return(x||b||h)&&document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[x,b,h]),t.useEffect(()=>{ie.send({hitType:"pageview",page:window.location.pathname,title:"Physio Connect Professional Form"})},[]),t.useEffect(()=>{(async()=>{try{const a=await pe(f);a.success?se(a.physioData):console.error("Error in response:",a.message)}catch(a){console.error("Error fetching physio data:",a)}await me().then(a=>{a.status>=200&&a.status<300?Z(a.data.data):a.status>=400&&a.status<500?o.error(a.data.message):o.error("Something went wrong")}),await ue().then(a=>{a.status>=200&&a.status<300?ee(a.data.data):a.status>=400&&a.status<500?o.error(a.data.message):o.error("Something went wrong")})})()},[]);const s=ge({initialValues:{bptDegree:{degreeId:""},mptDegree:{degreeId:""},specialization:[],experience:"",serviceType:[],iapMember:"",iapNumber:""},validationSchema:U().shape({iapMember:W().required("IAP member is required"),iapNumber:v().when("iapMember",{is:1,then:()=>v().required("IAP number is required"),otherwise:()=>v().notRequired()}),bptDegree:U({degreeId:v().required("BPT Degree is required")}),specialization:X().required("Specialization is required"),serviceType:X().required("Service Type is required"),experience:W().typeError("Experience must be a number").required("Experience is required").min(0,"Experience cannot be negative")}),onSubmit:r=>{const{bptDegree:a,mptDegree:n,specialization:i,experience:m,serviceType:c,iapMember:y,iapNumber:d}=r;if((i==null?void 0:i.length)==0)return o.error("Specialization is required");if((c==null?void 0:c.length)==0)return o.error("Please select treatment type");de({bptDegree:{degreeId:a.degreeId},mptDegree:{degreeId:n.degreeId},specialization:i,experience:m,serviceType:c,iapMember:y,iapNumber:d,physioConnectPhysioId:f}).then(I=>{var J,K;I.status===200?(o.success((J=I.data)==null?void 0:J.message),setTimeout(()=>{D("/physio-connect/business-details")},1e3)):o.error((K=I.data)==null?void 0:K.message)})}});if(t.useEffect(()=>{var r,a;l&&s.setValues({bptDegree:{degreeId:((r=l.bptDegree)==null?void 0:r.degreeId)||""},mptDegree:{degreeId:((a=l.mptDegree)==null?void 0:a.degreeId)||""},specialization:Array.isArray(l.specialization)?l.specialization:[],serviceType:Array.isArray(l.serviceType)?l.serviceType:[],experience:l.workExperience!==void 0?String(l.workExperience):"",iapMember:Number(l.iapMember)||0,iapNumber:String(l.iapNumber||"")})},[l]),t.useEffect(()=>{const r=p.find(i=>i.name==="General Physio");if(!r){console.warn("General specialization not found!");return}const a=r._id;console.log("General ID:",a);const n=s.values.bptDegree.degreeId?s.values.bptDegree.degreeId.length>0:!1;s.values.mptDegree.degreeId&&s.values.mptDegree.degreeId.length>0,n?(s.values.specialization||[]).includes(a)||s.setFieldValue("specialization",[a]):s.setFieldValue("specialization",[])},[s.values.bptDegree,s.values.mptDegree,p]),f==null||f.length==0){const r=sessionStorage.getItem("physioConnectId");if(r!=null)re(ne(r));else return e.jsx(oe,{to:"/physio-connect/signup"})}return t.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-[#FFFDF5] px-2 py-4  justify-center  md:px-8 lg:px-16",children:[e.jsx("div",{className:"flex-1 flex justify-center",children:e.jsx(xe,{currentStep:2})}),e.jsx("div",{className:"w-full max-w-6xl mx-auto border border-gray-200 rounded-lg bg-white px-4 md:px-12 py-8",children:e.jsxs("form",{onSubmit:s.handleSubmit,className:"flex flex-col gap-4 flex-1 max-w-screen-lg",children:[e.jsx("h6",{className:"font-semibold text-3xl",children:"Professional Details"}),e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Fill in your professional details below"}),e.jsx("label",{htmlFor:"",className:"text-sm font-semibold",children:"Select Degree"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"relative",ref:N,children:[s.values.bptDegree.degreeId&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(()=>{const r=g.find(a=>a._id===s.values.bptDegree.degreeId);return r&&e.jsxs("div",{className:"flex items-center gap-1 bg-[#F2FAF6] text-green px-2 py-1 rounded-full text-sm",children:[r.name,e.jsx("button",{type:"button",onClick:()=>s.setFieldValue("bptDegree.degreeId",null),className:"text-gray-600 hover:text-gray-800",children:"×"})]},r._id)})()}),e.jsxs("button",{type:"button",className:"flex items-center justify-between border px-3 py-2 rounded-md w-full cursor-pointer",onClick:()=>z(!b),children:[e.jsx("span",{children:"Select BPT degree"}),e.jsx("img",{src:"/aboutImg/dropdown.png",className:"w-4 h-4",alt:""})]}),b&&e.jsx("div",{className:"absolute z-10 w-full bg-white shadow-md rounded-md p-2 mt-1 border max-h-60 overflow-y-auto",children:e.jsx("div",{className:"flex flex-col gap-2",children:g.filter(r=>r.name==="Bachelor of Physiotherapy(BPT)"||r.name==="Diploma in Physiotherapy").map(r=>{const a=s.values.bptDegree.degreeId===r._id;return e.jsxs("label",{htmlFor:"bptdegree",className:"flex items-center gap-2 cursor-pointer p-1 hover:bg-gray-100 rounded",onClick:()=>s.setFieldValue("bptDegree.degreeId",a?null:r._id),children:[e.jsx("input",{type:"checkbox",name:"bptdegree",className:"w-4 h-4",value:r._id,checked:a,onChange:()=>{}}),r.name]},r._id)})})})]}),((C=s.touched.bptDegree)==null?void 0:C.degreeId)&&((k=s.errors.bptDegree)==null?void 0:k.degreeId)&&e.jsx("p",{className:"text-red-500",children:s.errors.bptDegree.degreeId})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-6",children:[e.jsxs("div",{className:"relative",ref:w,children:[s.values.mptDegree.degreeId&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(()=>{const r=g.find(a=>a._id===s.values.mptDegree.degreeId);return r&&e.jsxs("div",{className:"flex items-center gap-1 bg-[#F2FAF6] text-green px-2 py-1 rounded-full text-sm",children:[r.name,e.jsx("button",{type:"button",onClick:()=>s.setFieldValue("mptDegree.degreeId",null),className:"text-gray-600 hover:text-gray-800",children:"×"})]},r._id)})()}),e.jsxs("button",{type:"button",className:"flex items-center justify-between border px-3 py-2 rounded-md w-full cursor-pointer",onClick:()=>F(!h),children:[e.jsx("span",{children:"Select MPT degree"}),e.jsx("img",{src:"/aboutImg/dropdown.png",className:"w-4 h-4",alt:""})]}),h&&e.jsx("div",{className:"absolute z-10 w-full bg-white shadow-md rounded-md p-2 mt-1 border max-h-60 overflow-y-auto",children:e.jsx("div",{className:"flex flex-col gap-2",children:g.filter(r=>r.name==="Master of Physiotherapy").map(r=>{const a=s.values.mptDegree.degreeId===r._id;return e.jsxs("label",{htmlFor:"mptdegree",className:"flex items-center gap-2 cursor-pointer p-1 hover:bg-gray-100 rounded",onClick:()=>s.setFieldValue("mptDegree.degreeId",a?null:r._id),children:[e.jsx("input",{type:"checkbox",name:"mptdegree",className:"w-4 h-4",value:r._id,checked:a,onChange:()=>{}}),r.name]},r._id)})})})]}),((P=s.touched.mptDegree)==null?void 0:P.degreeId)&&((A=s.errors.mptDegree)==null?void 0:A.degreeId)&&e.jsx("p",{className:"text-red-500",children:s.errors.mptDegree.degreeId})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"specialization",className:"text-sm font-semibold",children:"Select Speciality"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:s.values.specialization.map(r=>{const a=p.find(n=>n._id===r);return a&&e.jsxs("div",{className:"flex items-center gap-1  bg-[#F2FAF6] text-green px-2 py-1 rounded-full text-sm",children:[a.name,e.jsx("button",{type:"button",onClick:()=>{const n=s.values.specialization.filter(i=>i!==r);s.setFieldValue("specialization",n)},className:"text-gray-600 hover:text-gray-800",children:"×"})]},r)})}),e.jsxs("button",{type:"button",className:"flex items-center justify-between border px-3 py-2 rounded-md w-full cursor-pointer",onClick:()=>S(!x),children:[e.jsx("span",{children:"Select Speciality"}),e.jsx("img",{src:"/aboutImg/dropdown.png",className:"w-4 h-4",alt:""})]}),x&&e.jsx("div",{ref:j,className:"absolute z-10 w-full bg-white shadow-md rounded-md p-2 mt-1 border max-h-60 overflow-y-auto",children:e.jsx("div",{className:"flex flex-col gap-2",children:p.map(r=>e.jsxs("label",{htmlFor:"specialization",className:"flex items-center gap-2 cursor-pointer p-1 hover:bg-gray-100 rounded",onClick:()=>{var c,y;const a=(c=p.find(d=>d.name==="General Physio"))==null?void 0:c._id,n=s.values.specialization.includes(r._id);if(!((y=s.values.mptDegree)!=null&&y.degreeId)||r._id===a)return;const i=s.values.specialization;let m;n?m=i.filter(d=>d!==r._id):m=i.filter(d=>d===a).concat(r._id),s.setFieldValue("specialization",m)},children:[e.jsx("input",{type:"checkbox",name:"specialization",className:"w-4 h-4",value:r._id,checked:s.values.specialization.includes(r._id),onChange:()=>{}}),r.name]},r._id))})})]}),((T=(E=(_=s.values)==null?void 0:_.bptDegree)==null?void 0:E.degreeId)==null?void 0:T.length)>0&&!((V=(q=(M=s.values)==null?void 0:M.mptDegree)==null?void 0:q.degreeId)!=null&&V.length)&&((G=(B=s.values)==null?void 0:B.specialization)==null?void 0:G.length)===1&&((R=p.find(r=>r.name==="General Physio"))==null?void 0:R._id)===s.values.specialization[0]&&e.jsx("p",{className:"text-yellow-900 text-sm font-medium",children:"You selected only BPT. So you only get General Physio."}),((L=($=(O=s.values)==null?void 0:O.bptDegree)==null?void 0:$.degreeId)==null?void 0:L.length)>0&&((Q=(H=(Y=s.values)==null?void 0:Y.mptDegree)==null?void 0:H.degreeId)==null?void 0:Q.length)>0&&e.jsx("p",{className:"text-yellow-900 text-sm font-medium",children:"You can select one more specialization."}),s.touched.specialization&&s.errors.specialization&&e.jsx("p",{className:"text-red-500",children:s.errors.specialization})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"experience",className:"text-sm font-semibold ",children:"Experience (in years)"}),e.jsx(u.Input,{size:"md",name:"experience",value:s.values.experience,onChange:s.handleChange,type:"number",labelProps:{className:"hidden"},placeholder:"Enter your experience",className:"border-none placeholder:text-gray-300 placeholder:opacity-100 bg-white ring-1 ring-[#A9ABB2] focus:ring-2 focus:ring-black"})]}),s.touched.experience&&s.errors.experience?e.jsx("div",{className:"text-red-500 mt-2",children:s.errors.experience}):null]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"iapMember",className:"text-sm font-semibold",children:"Are you registered with IAP?"}),e.jsxs("select",{id:"iapMember",name:"iapMember",value:s.values.iapMember===""?"":s.values.iapMember.toString(),onChange:r=>{const a=Number(r.target.value);s.setFieldValue("iapMember",a),a===0&&(s.setFieldValue("iapNumber",""),s.setFieldValue("iapImage",[]))},className:"border border-gray-300 rounded-md px-3 py-2 w-full cursor-pointer focus:outline-none focus:ring-1 focus:ring-black focus:border-black bg-white",children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Select an option"}),e.jsx("option",{value:1,children:"Yes"}),e.jsx("option",{value:0,children:"No"})]}),s.touched.iapMember&&s.errors.iapMember&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:s.errors.iapMember})]}),s.values.iapMember===1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"iapNumber",className:"text-sm font-semibold",children:"Enter your IAP Number"}),e.jsx(u.Input,{size:"md",name:"iapNumber",required:s.values.iapMember===1,value:s.values.iapNumber,onChange:s.handleChange,labelProps:{className:"hidden"},placeholder:"Enter IAP Number",className:"border-none placeholder:text-gray-300 placeholder:opacity-100 bg-white ring-1 ring-[#A9ABB2] focus:ring-2 focus:ring-black"})]}),s.touched.iapNumber&&s.errors.iapNumber?e.jsx("div",{className:"text-red-500 mt-2",children:s.errors.iapNumber}):null]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"serviceType",className:"text-sm font-semibold",children:"Select Service Type"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-900 font-medium",children:[e.jsx(u.Checkbox,{className:"rounded-sm h-4 w-4 border-green border-2  hover:before:opacity-0 checked:bg-green text-green",checked:s.values.serviceType.includes("clinic"),name:"serviceType",value:"clinic",type:"checkbox",onChange:s.handleChange}),"Clinic"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-900 font-medium",children:[e.jsx(u.Checkbox,{className:"rounded-sm h-4 w-4 border-green border-2  hover:before:opacity-0 checked:bg-green text-green",checked:s.values.serviceType.includes("home"),type:"checkbox",name:"serviceType",value:"home",onChange:s.handleChange}),"Home Care"]})]}),s.touched.serviceType&&s.errors.serviceType&&e.jsx("p",{className:"text-red-500",children:s.errors.serviceType})]}),e.jsxs("div",{className:"w-full flex flex-row justify-between items-center mt-4 gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>D(-1),className:"text-black hover:text-green font-medium flex items-center gap-1 text-sm sm:text-base",children:[e.jsx(ce,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Go Back"]}),e.jsx(u.Button,{className:"w-fit  font-semibold hover:shadow-none  px-6 sm:px-12 bg-green rounded-full py-3 ",type:"submit",children:"Submit & Next"})]})]})})]})})};export{Ne as default};
