import{x as T,z as _,e as U,d as l,j as e,S as V,T as q,_ as f,U as B,V as K}from"./index-B5YKgjKu.js";import{E as X,C as D,a as S}from"./ellipsis-vertical-2zkrArWQ.js";import{X as O}from"./x--gYKR96B.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],H=T("circle-check",Y);function ee(){var j,y,w,N,v,C;const{id:o}=_(),P=U(),[s,p]=l.useState(null),[J,I]=l.useState(!0),[i,L]=l.useState(!0),[m,R]=l.useState(!0),[z,x]=l.useState(!1),[A,u]=l.useState(!1),[r,h]=l.useState(["","","",""]),g=[l.useRef(),l.useRef(),l.useRef(),l.useRef()],[M,c]=l.useState(!1),[d,$]=l.useState(null);l.useEffect(()=>{o&&(async()=>{try{const a=await B(o);p(a)}catch(a){console.error("Error loading consultation:",a)}finally{I(!1)}})()},[o]);const E=(t,a)=>{if(!/^[0-9]?$/.test(a))return;const n=[...r];n[t]=a,h(n),a&&t<3&&g[t+1].current.focus()},F=(t,a)=>{a.key==="Backspace"&&!r[t]&&t>0&&g[t-1].current.focus()},b=()=>{x(!1),h(["","","",""])},G=async()=>{const t=r.join("");if(t.length===4)try{await K({consultationId:o,otp:t}),x(!1),u(!0),h(["","","",""])}catch(a){console.error("OTP Verification Failed",a),f.error("Invalid OTP. Please try again.")}};return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-white px-4 py-6 pb-32",children:[e.jsx("div",{className:"font-semibold text-md mb-4 flex justify-center",children:"patient Details"}),e.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm flex flex-col gap-4 relative",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:((j=s==null?void 0:s.patientId)==null?void 0:j.profilePhoto)||"/homecare/user.png",alt:(y=s==null?void 0:s.patientId)==null?void 0:y.fullName,className:"w-14 h-14 rounded-full object-cover border"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-base",children:((w=s==null?void 0:s.patientId)==null?void 0:w.fullName)||"Patient"}),e.jsx("p",{className:"text-xs text-gray-700",children:"Consultation"}),e.jsx("div",{className:"flex gap-4 mt-1 text-xs text-gray-600",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"w-4 h-4"}),new Date(s==null?void 0:s.date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})]})})]})]}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(X,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("button",{onClick:()=>c(!0),className:"border border-green text-green text-sm rounded-lg px-5 py-1 font-semibold w-full my-2",children:"Reschedule"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg",children:[e.jsxs("button",{className:"flex w-full items-center justify-between px-3 py-2 font-semibold text-gray-800",onClick:()=>L(!i),children:[e.jsx("span",{children:"General Details"}),i?e.jsx(D,{}):e.jsx(S,{})]}),i&&e.jsxs("div",{className:"px-3 pb-3 text-xs text-gray-600 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Gender: "}),(s==null?void 0:s.gender)===0?"Female":(s==null?void 0:s.gender)===1?"Male":"Other"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Age: "}),s==null?void 0:s.age]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Consultation Amount: "}),"₹",s==null?void 0:s.amount]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Payment Method: "}),s==null?void 0:s.paymentMode]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg",children:[e.jsxs("button",{className:"flex w-full items-center justify-between px-3 py-2 font-semibold text-gray-800",onClick:()=>R(!m),children:[e.jsx("span",{children:"Patient Problem"}),m?e.jsx(D,{}):e.jsx(S,{})]}),m&&e.jsx("div",{className:"px-3 pb-3 text-xs text-gray-700",children:(s==null?void 0:s.painNotes)||"No problem description."})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex items-start justify-between gap-3 text-xs text-gray-700",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-semibold text-gray-800 mb-1",children:[((N=s==null?void 0:s.patientId)==null?void 0:N.fullName)||"Patient","'s Address"]}),e.jsx("p",{className:"whitespace-pre-wrap leading-snug text-gray-600",children:((C=(v=s==null?void 0:s.patientId)==null?void 0:v.appointmentAddress)==null?void 0:C.replace(/\n?Lat:.*$/i,""))||"Address not available"})]}),e.jsx("button",{className:"bg-green hover:bg-green/90 transition text-white text-xs px-4 py-1.5 rounded-md font-medium whitespace-nowrap mt-1",onClick:()=>{var k;const t=(k=s==null?void 0:s.patientId)==null?void 0:k.appointmentAddress;if(!t)return alert("Address not available");const a=t.match(/Lat:\s*([-0-9.]+),\s*Lng:\s*([-0-9.]+)/),n=a?`https://www.google.com/maps?q=${a[1]},${a[2]}`:`https://www.google.com/maps?q=${encodeURIComponent(t.replace(/\n?Lat:.*$/i,""))}`;window.open(n,"_blank")},children:"📍 Locate"})]}),e.jsx("button",{onClick:()=>{s!=null&&s.appointmentCompleted||x(!0)},disabled:s==null?void 0:s.appointmentCompleted,className:`w-full max-w-md mx-auto text-base py-3 rounded-lg font-semibold shadow-lg ${s!=null&&s.appointmentCompleted?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-green text-white hover:bg-green/90"}`,children:s!=null&&s.appointmentCompleted?"Consultation Completed":"Start Consultation"})]}),z&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm z-50",onClick:b}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 px-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-sm w-full p-6 relative",children:[e.jsx("button",{onClick:b,className:"absolute top-3 right-3 p-1 rounded-full hover:bg-gray-100",children:e.jsx(O,{className:"w-5 h-5 text-gray-400"})}),e.jsx("h2",{className:"text-lg font-semibold mb-2 text-center",children:"Verify Appointment"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4 text-center",children:"Please submit the OTP received by the patient at the time of booking this appointment."}),e.jsx("div",{className:"flex justify-center gap-2 mb-4",children:r.map((t,a)=>e.jsx("input",{ref:g[a],type:"text",inputMode:"numeric",maxLength:1,className:"w-12 h-12 rounded-lg border-2 text-center text-lg font-bold bg-gray-50 border-gray-200 focus:border-green outline-none",value:t,onChange:n=>E(a,n.target.value),onKeyDown:n=>F(a,n)},a))}),e.jsx("button",{onClick:G,disabled:r.join("").length!==4,className:"w-full bg-green text-white rounded-lg py-2 font-semibold text-base disabled:opacity-60",children:"Confirm"})]})})]}),M&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm z-50",onClick:()=>c(!1)}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 px-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-sm w-full p-6 relative",children:[e.jsx("button",{onClick:()=>c(!1),className:"absolute top-3 right-3 p-1 rounded-full hover:bg-gray-100",children:e.jsx(O,{className:"w-5 h-5 text-gray-400"})}),e.jsx("h2",{className:"text-lg font-semibold text-center mb-2",children:"Reschedule Consultation"}),e.jsxs("p",{className:"text-sm text-gray-500 text-center mb-4",children:["Old Date:"," ",e.jsx("span",{className:"font-semibold",children:new Date(s==null?void 0:s.date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsx("input",{type:"date",min:new Date().toISOString().split("T")[0],value:d||"",onChange:t=>$(t.target.value),className:"w-full mt-3 bg-gray-50 border px-3 py-2 rounded-lg"}),e.jsxs("div",{className:"mt-5 flex gap-4",children:[e.jsx("button",{onClick:()=>c(!1),className:"w-full py-2 border border-gray-300 rounded-lg text-gray-700",children:"Cancel"}),e.jsx("button",{onClick:async()=>{try{await q({consultationId:o,newDate:d}),f.success("Consultation rescheduled!"),p({...s,date:d}),c(!1)}catch(t){console.error(t),f.error("Failed to reschedule consultation.")}},disabled:!d,className:"w-full py-2 bg-green text-white rounded-lg font-semibold disabled:opacity-60",children:"Confirm"})]})]})})]}),A&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm z-50",onClick:()=>u(!1)}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 px-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-sm w-full p-7 relative flex flex-col items-center",children:[e.jsx(H,{className:"w-12 h-12 text-green mb-3"}),e.jsx("h2",{className:"text-lg font-semibold text-center mb-1",children:"Consultation Completed"}),e.jsx("p",{className:"text-sm text-center text-gray-600 mb-6",children:"Great work! You've successfully completed this consultation."}),e.jsx("button",{className:"w-full bg-green text-white rounded-lg py-2 mt-1 font-semibold text-base",onClick:()=>{u(!1),P(`/homecare/physio-consultation/${o}`)},children:"Go to Consultation"})]})})]})]})}export{ee as default};
