import{d as n,j as e}from"./index-DPswVjmk.js";import{X as S}from"./x-0Syscb_O.js";function _({isOpen:d,onClose:j,onLocationSelect:w}){const i=n.useRef(null),p=n.useRef(null),g=n.useRef(null),[u,L]=n.useState(""),[m,v]=n.useState(""),[x,y]=n.useState(""),[o,N]=n.useState(null);n.useEffect(()=>{if(!d||!window.google||!i.current)return;(()=>{navigator.geolocation.getCurrentPosition(c=>{const l={lat:c.coords.latitude,lng:c.coords.longitude},a=new window.google.maps.Map(i.current,{center:l,zoom:16}),r=new window.google.maps.Marker({map:a,position:l,draggable:!0});p.current=r,g.current=new window.google.maps.Geocoder,f(l),r.addListener("dragend",()=>{const t=r.getPosition(),s={lat:t.lat(),lng:t.lng()};f(s)}),a.addListener("click",t=>{const s={lat:t.latLng.lat(),lng:t.latLng.lng()};r.setPosition(s),f(s)})},()=>{alert("Location permission denied.")})})()},[d]);const f=h=>{N(h),g.current&&g.current.geocode({location:h},(c,l)=>{if(l==="OK"&&c[0]){const a=c[0],r=a.address_components,t=a.formatted_address,s=t.match(/\b\d{6}\b/),k=s?s[0]:"",b=r.find(M=>["sublocality","neighborhood","locality"].some(A=>M.types.includes(A))),R=(b==null?void 0:b.long_name)||"";L(t),v(R),y(k)}})},P=()=>{if(!u||!o){alert("Please wait for location to load...");return}w({address:u,nearby:m,pincode:x,lat:o.lat,lng:o.lng}),j()};return d?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 w-[95%] max-w-2xl h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Pin Your Location"}),e.jsx("button",{onClick:j,children:e.jsx(S,{className:"w-5 h-5 text-gray-700"})})]}),e.jsx("div",{ref:i,className:"flex-1 border rounded mb-3"}),e.jsxs("div",{className:"text-sm text-gray-700 space-y-1 mb-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Address:"})," ",u||"Fetching..."]}),m&&e.jsxs("div",{children:[e.jsx("strong",{children:"Nearby:"})," ",m]}),x&&e.jsxs("div",{children:[e.jsx("strong",{children:"Pincode:"})," ",x]}),o&&e.jsxs("div",{children:[e.jsx("strong",{children:"Lat/Lng:"})," ",o.lat,", ",o.lng]})]}),e.jsx("button",{className:"mt-1 w-full bg-green hover:bg-[#15692c] text-white py-2 rounded-md text-sm",onClick:P,children:"Confirm Location"})]})}):null}export{_ as L};
