import{d as a,j as e,e as F,aM as T,o as E,A as k,c as M,aN as O,_ as R,a9 as L,r as _,L as A,ag as U}from"./index-CWqE7d4E.js";import{c as Y,a as $,F as B,d as V,e as H}from"./formik.esm-DzpjA8y5.js";import{a as P}from"./index-bSxdlk4j.js";const I=({onClose:s,onSubmit:c})=>{const[x,p]=a.useState(0),b=Y().shape({review:$().required("Review is required")});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-[90%] max-w-sm shadow-lg relative pt-10",children:[e.jsx("button",{className:"absolute top-2 right-4 text-xl",onClick:s,children:"âœ•"}),e.jsx("h2",{className:"text-center font-semibold text-lg",children:"Help Us Improve. Your Opinion Matters!"}),e.jsx("p",{className:"text-center mt-2 mb-4 text-sm",children:"Rate your Physio"}),e.jsx("div",{className:"flex justify-center gap-2 mb-4",children:[1,2,3,4,5].map(i=>e.jsx("span",{className:`text-2xl cursor-pointer ${x>=i?"text-yellow-400":"text-gray-300"}`,onClick:()=>p(i),children:"â˜…"},i))}),e.jsx(B,{initialValues:{review:""},validationSchema:b,onSubmit:(i,d)=>{c({...i,rating:x}),d.resetForm(),s()},children:({errors:i,touched:d})=>e.jsxs(V,{className:"space-y-4",children:[e.jsx(H,{as:"textarea",name:"review",placeholder:"Write your review here",className:"w-full p-3 border border-gray-300 rounded-md resize-none text-sm focus:outline-none focus:ring-2 focus:ring-emerald-400",rows:4}),i.review&&d.review&&e.jsx("div",{className:"text-red-500 text-xs",children:i.review}),e.jsx("button",{type:"submit",className:"w-full bg-black text-white py-2 rounded-full hover:bg-gray-900",children:"Submit"})]})})]})})},W=({orderData:s})=>{var j,m,o;const c=F(),[x,p]=a.useState(!1),[b,{isLoading:i,isSuccess:d,error:y}]=T(),v=async h=>{var N,f,g;try{const l=await b({appointmentId:s==null?void 0:s._id,patientId:(N=s==null?void 0:s.patientId)==null?void 0:N._id,physioId:(f=s==null?void 0:s.physioId)==null?void 0:f._id,rating:h.rating,comment:h.review}).unwrap();k.success("Review submitted successfully!")}catch(l){console.error("Error submitting review:",l);const w=l==null?void 0:l.status,S=((g=l==null?void 0:l.data)==null?void 0:g.message)||"Something went wrong.";k.error(`Error ${w}: ${S}`)}},u=()=>{c("/order-details",{state:{appointmentId:s==null?void 0:s._id}})};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
					@keyframes fadeIn {
						from { opacity: 0; transform: translateY(-2px); }
						to { opacity: 1; transform: translateY(0); }
					}
					.animate-fade {
						animation: fadeIn 0.2s ease-out;
					}
				`}),e.jsx("div",{className:"w-full  md:bg-[#E6F4EC]  rounded-3xl border border-[#E6F4EC] shadow-md overflow-hidden ",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between bg-white ",children:[e.jsxs("div",{className:"w-full md:w-fit flex items-center gap-4 p-2",children:[e.jsx("div",{className:"relative rounded-full overflow-hidden ",children:e.jsx("img",{src:(j=s==null?void 0:s.physioId)!=null&&j.profileImage?s.physioId.profileImage:"./mockPhysioMale.png",alt:(m=s==null?void 0:s.physioId)==null?void 0:m.fullName,className:"object-cover w-20 h-20 aspect-square"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-[#4a4e69] mb-1",children:(o=s==null?void 0:s.physioId)==null?void 0:o.fullName}),e.jsxs("div",{className:"font-semibold text-gray-500 text-md",children:[(s==null?void 0:s.serviceType)===0?"Home":(s==null?void 0:s.serviceType)===1?"Clinic":"Online"," ","Visit"]})]}),e.jsxs("div",{className:"flex flex-wrap sm:flex-row gap-2 md:gap-6 px-2 md:px-0",children:[e.jsxs("div",{className:"flex items-center gap-1 text-black font-normal text-xs md:text-sm lg:text-base",children:[e.jsx("img",{src:"/images/CalendarBlank.png",alt:"",className:"w-4 h-4"}),e.jsx("span",{children:E(s==null?void 0:s.date).format("dddd, DD.MM.YYYY")})]}),e.jsxs("div",{className:"flex items-center gap-1 text-black font-normal text-xs md:text-sm lg:text-base",children:[e.jsx("img",{src:"/images/Clock.png",alt:"",className:"w-4 h-4"}),e.jsx("span",{children:s==null?void 0:s.timeInString})]}),(s==null?void 0:s.otp)&&e.jsxs("span",{className:"text-xs md:text-sm text-green font-semibold px-0 md:px-4",children:["OTP: ",s==null?void 0:s.otp]})]})]})]}),e.jsx("div",{className:"hidden md:block p-2",children:e.jsxs("div",{className:"font-medium",children:["â‚¹ ",s==null?void 0:s.amount]})}),e.jsx("div",{className:"md:border-l-2 p-2 ",children:e.jsxs("div",{className:" w-full md:w-fit flex flex-col gap-2 mt-4 md:mt-0  p-2 ",children:[e.jsx("button",{onClick:u,className:"w-64 md:w-full text-sm md:text-base bg-green text-white  px-6 sm:px-20 md:px-10 py-2 rounded-full hover:bg-emerald-700 transition-colors",children:"View Details"}),e.jsx("button",{onClick:()=>p(!0),className:"w-64 md:w-full text-sm md:text-base bg-[#F1F9F4] text-center text-black px-6 sm:px-10 md:px-12 py-2 rounded-full hover:bg-emerald-700 transition-colors",children:"Write a review"}),x&&e.jsx(I,{onClose:()=>p(!1),onSubmit:v})]})})]})})]})},q=({orderData:s})=>{var u,j,m,o,h,N,f,g,l;const c=F(),[x,p]=a.useState(!1),[b]=T(),i=async w=>{var S,C,t;try{await b({appointmentId:s==null?void 0:s._id,patientId:(S=s==null?void 0:s.patientId)==null?void 0:S._id,physioId:(C=s==null?void 0:s.physioId)==null?void 0:C._id,rating:w.rating,comment:w.review}).unwrap(),k.success("Review submitted successfully!")}catch(n){const r=((t=n==null?void 0:n.data)==null?void 0:t.message)||"Something went wrong.";k.error(`Error: ${r}`)}},d=()=>{c("/treatment-details",{state:{treatmentId:s==null?void 0:s._id}})},y=()=>{c("/contact",{state:{orderData:s}})},v=(u=s==null?void 0:s.isTreatmentScheduled)==null?void 0:u.isTreatmentCompleted;return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-2px); }
            to { opacity: 1; transform: translateY(0); }
          }
          .animate-fade {
            animation: fadeIn 0.2s ease-out;
          }
        `}),e.jsx("div",{className:"w-full md:bg-[#E6F4EC] rounded-3xl border border-[#E6F4EC] shadow-md overflow-hidden",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between bg-white",children:[e.jsxs("div",{className:"w-full md:w-fit flex items-center gap-4 p-2",children:[e.jsx("div",{className:"relative rounded-full overflow-hidden",children:e.jsx("img",{src:((j=s==null?void 0:s.physioId)==null?void 0:j.profileImage)||"/mockPhysioMale.png",alt:(m=s==null?void 0:s.physioId)==null?void 0:m.fullName,className:"object-cover w-20 h-20 aspect-square"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-lg font-medium text-[#4a4e69] mb-1",children:(o=s==null?void 0:s.physioId)==null?void 0:o.fullName}),e.jsxs("div",{className:"font-semibold text-gray-500 text-md",children:[((h=s==null?void 0:s.isTreatmentScheduled)==null?void 0:h.treatmentServiceType)===0?"Home":((N=s==null?void 0:s.isTreatmentScheduled)==null?void 0:N.treatmentServiceType)===1?"Clinic":"Online"," ","Treatment"]}),e.jsx("div",{className:"flex gap-6 flex-wrap",children:e.jsxs("div",{className:"flex items-center gap-1 text-black font-normal text-xs md:text-sm lg:text-base",children:[e.jsx("img",{src:"/images/Clock.png",alt:"",className:"w-4 h-4"}),e.jsxs("span",{children:[(f=s==null?void 0:s.isTreatmentScheduled)==null?void 0:f.startTime," -"," ",(g=s==null?void 0:s.isTreatmentScheduled)==null?void 0:g.endTime]})]})})]})]}),e.jsx("div",{className:"hidden md:block p-2",children:e.jsxs("div",{className:"font-medium",children:["â‚¹ ",(l=s==null?void 0:s.isTreatmentScheduled)==null?void 0:l.amount]})}),e.jsx("div",{className:"md:border-l-2 p-2",children:e.jsxs("div",{className:"w-full md:w-fit flex flex-col gap-2 mt-4 md:mt-0 p-2",children:[e.jsx("button",{onClick:d,className:"w-64 md:w-full text-sm md:text-base bg-green text-white px-6 sm:px-20 md:px-10 py-2 rounded-full hover:bg-emerald-700 transition-colors",children:"View Details"}),v?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>p(!0),className:"w-64 md:w-full text-sm md:text-base bg-[#F1F9F4] text-black px-6 sm:px-10 md:px-12 py-2 rounded-full hover:bg-emerald-700 transition-colors",children:"Write a review"}),x&&e.jsx(I,{onClose:()=>p(!1),onSubmit:i})]}):e.jsx("button",{onClick:y,className:"w-64 md:w-full text-sm md:text-base bg-[#F1F9F4] text-black px-6 sm:px-10 md:px-12 py-2 rounded-full hover:bg-red-200 transition-colors",children:"Contact Support"})]})})]})})]})},J=()=>{const s=F(),{userId:c,userToken:x}=M(t=>t.auth.user||{}),[p,b]=a.useState([]),[i,d]=a.useState(!1),[y,v]=a.useState("Upcoming"),[u,j]=a.useState(""),[m,o]=a.useState("Appointment");a.useEffect(()=>{if(!c){s("/login");return}d(!0),O(c,x).then(t=>b(t.data)).catch(t=>R.error(t.message||"Failed to fetch orders")).finally(()=>d(!1))},[c,x]);const h=[...p||[]].reverse(),f=h.filter(t=>m==="Appointment"&&(t==null?void 0:t.appointmentStatus)===0||(t==null?void 0:t.appointmentStatus)===1).filter(t=>{var n,r;return m==="Appointment"?y==="Completed"?(t==null?void 0:t.appointmentCompleted)===!0:(t==null?void 0:t.appointmentCompleted)===!1&&(t==null?void 0:t.status)!=="Canceled":y==="Completed"?((n=t==null?void 0:t.isTreatmentScheduled)==null?void 0:n.isTreatmentCompleted)===!0:((r=t==null?void 0:t.isTreatmentScheduled)==null?void 0:r.isTreatmentCompleted)===!1&&(t==null?void 0:t.status)!=="Canceled"}),g=u?f.filter(t=>{var n,r;return(r=(n=t==null?void 0:t.physioId)==null?void 0:n.fullName)==null?void 0:r.toLowerCase().includes(u.toLowerCase())}):f,l=h.filter(t=>(t==null?void 0:t.appointmentStatus)===0||(t==null?void 0:t.appointmentStatus)===1),w=h.filter(t=>(t==null?void 0:t.appointmentStatus)===1),S={Upcoming:l.filter(t=>!t.appointmentCompleted&&t.status!=="Canceled").length,Completed:l.filter(t=>t.appointmentCompleted).length},C={Upcoming:w.filter(t=>{var n;return!((n=t==null?void 0:t.isTreatmentScheduled)!=null&&n.isTreatmentCompleted)&&t.status!=="Canceled"}).length,Completed:w.filter(t=>{var n;return(n=t==null?void 0:t.isTreatmentScheduled)==null?void 0:n.isTreatmentCompleted}).length};return a.useEffect(()=>{L.send({hitType:"pageview",page:window.location.pathname,title:"Order History"})},[]),e.jsxs("div",{className:"font-Urbanist bg-[#FFFCF0] py-8 px-4 sm:px-12 lg:px-[120px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4",children:[e.jsxs(_.Breadcrumbs,{separator:">",className:"text-black bg-transparent",children:[e.jsx(A,{to:"/profile",className:"text-black font-semibold hover:text-green",children:"My Account"}),e.jsx("span",{className:"text-black font-bold",children:"My Bookings"})]}),e.jsxs("div",{className:"flex items-center border-2 bg-white border-green rounded-md overflow-hidden mt-2 md:mt-0",children:[e.jsx("div",{className:"bg-green-500 p-2 flex items-center justify-center",children:e.jsx(P,{className:"text-black w-4 h-4"})}),e.jsx("input",{type:"text",placeholder:"Search with physio name",value:u,onChange:t=>j(t.target.value),className:"px-4 py-2 focus:outline-none"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 p-4",children:[e.jsxs("div",{onClick:()=>{o("Appointment"),v("Upcoming")},className:`flex items-center gap-4 p-4 rounded-lg border cursor-pointer w-full md:w-1/2 ${m==="Appointment"?"bg-[#08845f]":"bg-gray-400"}`,children:[e.jsx("div",{className:"bg-[#d9ffe3] text-green p-2 rounded-full",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16h6m2 4H7a2 2 0 01-2-2V6a2 2 0 012-2h4l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-white",children:["Consultation (",l.length,")"]}),e.jsx("p",{className:"text-sm text-white",children:"Export medical consultations"})]})]}),e.jsxs("div",{onClick:()=>{o("Treatment"),v("Upcoming")},className:`flex items-center gap-4 p-4 rounded-lg border cursor-pointer w-full md:w-1/2 ${m==="Treatment"?"bg-[#18c1a7]":"bg-gray-400"}`,children:[e.jsx("div",{className:"bg-blue-100 text-white p-2 rounded-full",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2a4 4 0 118 0v2m-4-6v.01M12 6.25a4.25 4.25 0 110 8.5 4.25 4.25 0 010-8.5z"})})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-white",children:["Treatment (",w.length,")"]}),e.jsx("p",{className:"text-sm text-white",children:"Export medical treatments"})]})]})]}),e.jsx("div",{className:"flex flex-wrap md:flex-nowrap gap-2 px-4 pt-4 text-sm md:text-base font-medium overflow-x-auto scrollbar-hide",children:["Upcoming","Completed"].map(t=>e.jsxs("button",{onClick:()=>v(t),className:`flex items-center gap-2 px-3 py-1 rounded-md whitespace-nowrap ${y===t?"bg-[#f0fff5] text-green-800":"bg-gray-100 text-gray-800"}`,children:[e.jsx("img",{src:t==="Upcoming"?"/images/upcoming 1.png":"/images/successful 1.png",alt:"",className:"h-5 w-5"}),t," (",m==="Appointment"?S[t]:C[t],")"]},t))}),e.jsx("hr",{className:"my-4"}),e.jsx("div",{className:"p-4",children:i?e.jsx(U,{}):g.length>0?g.map(t=>e.jsx("div",{className:"mb-4",children:(t==null?void 0:t.appointmentStatus)===1?e.jsx(q,{orderData:t}):e.jsx(W,{orderData:t})},t==null?void 0:t._id)):e.jsx("p",{className:"text-center text-gray-500",children:"No orders found."})})]})]})};export{J as default};
